\section{Smart Contracts}
The code for the SCs is available on GitHub\footnote{\href{https://github.com/bc-ticketing/idetix}{https://github.com/bc-ticketing/idetix}}. The Truffle\footnote{\href{https://www.trufflesuite.com}{https://www.trufflesuite.com}} framework was used to build, test and deploy the SC. Truffle simplifies the process of deploying the contracts to a local Ethereum node or to any of the public testnets.

\subsection{Compilation}
Truffle can also compile the contracts and generate the ABIs which are needed when integrating the contracts in another application.

\noindent To compile to contract and generate the ABI run the following command:
\begin{lstlisting}[language=bash]
  $ truffle compile
\end{lstlisting}

This will generate or overwrite the existing folder called \textit{abi} in the root directory. 

\subsection{Testing}

In order to run the tests, a local Ethereum network can be created with Ganache\footnote{\href{https://www.trufflesuite.com/ganache}{https://www.trufflesuite.com/ganache}}. It is recommended to use \textit{ganache-cli} instead of their GUI application.

\noindent To start a local Ethereum BC with Ganache run the following command:
\begin{lstlisting}[language=bash]
  $ ganache-cli --h 0.0.0.0
\end{lstlisting}

\noindent To run the tests against the local Ethereum BC:
\begin{lstlisting}[language=bash]
  $ truffle test --network ganachecli
\end{lstlisting}

\subsection{Deployment}
Deploying the contracts to a (local) testnet or mainnet can be also be done with Truffle. 

\subsubsection{Local}

\noindent To deploy the contracts to the local Ganache instance:
\begin{lstlisting}[language=bash]
  $  truffle migrate --reset --network ganachecli
\end{lstlisting}

\subsubsection{Public Testnet}

Deploying to a public testnet requires a connection to an Ethereum node of the desired network must be established. For this one can use Infura\footnote{\href{https://infura.io}{https://infura.io}} API. Furthermore, one must have an account with Ether to cover the deployment costs. There are multiple faucets for each of the public testnets that send free test ETH. 

Also, an additional NPM package\footnote{\href{https://www.npmjs.com/package/@truffle/hdwallet-provider}{https://www.npmjs.com/package/@truffle/hdwallet-provider}} is used to deploy the contracts. It enables Truffle to deploy to a public testnet by providing a mnemonic and a URL to the Ethereum node.

First, a local file in the root directory called \textit{.env} and past the correct values from Infura and your mnemonic.

\begin{lstlisting}
MNEMONIC="<...>"
ROPSTEN_URL="https://ropsten.infura.io/v3/<...>"
RINKEBY_URL="https://rinkeby.infura.io/v3/<...>"
\end{lstlisting}

\noindent To deploy the contracts to a public testnet run the following code:
\begin{lstlisting}[language=bash]
  $  truffle migrate --reset --network <ropsten or rinkeby>
\end{lstlisting}
